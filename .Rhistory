proteins_log
# import libraries
library(tidyverse)
library(ComplexHeatmap)
library(stats)
# Import data sets
combined_dataset <- read.csv("combined_dataset.csv")
features_somameres <- read.csv("feature_meta.csv")
# Heads of both combined_datasets
head(combined_dataset)
head(features_somameres)
# Split the combined_dataset in protein expression levels and meta data
combined_dataset_protein <-combined_dataset[,1:7241]
combined_dataset_features <-combined_dataset[,7242:7258]
# Columns: sex, ethnicity, ... converted to factors
clinical_data <- c("ethnicity", "sex", "ihd", "previous_vte","copd", "diabetes", "smoking", "cause_eskd",
"WHO_severity", "WHO_temp_severity", "case_control","radiology_evidence_covid", "fatal_disease")
combined_dataset_features[clinical_data] <- lapply((combined_dataset_features[clinical_data]),factor)
str(combined_dataset_features)
# Log transforming and scale data
proteins_log <- log(combined_dataset_protein[,2:7241])
protein_scaled <- as.data.frame(scale(proteins_log))
proteins_scaled_ids <- protein_scaled %>% mutate(X = combined_dataset_protein$X) %>% arrange()
proteins_log
protein_scaled
proteins_scaled_ids
proteins_scaled_ids <- protein_scaled %>% mutate(X = combined_dataset_protein$X) %>% [:7241]
proteins_scaled_ids <- protein_scaled %>% mutate(X = combined_dataset_protein$X) %>% [,7241]
proteins_scaled_ids <- protein_scaled %>% mutate(X = combined_dataset_protein$X) %>% [,7241]
proteins_scaled_ids[,7241]
proteins_scaled_ids <- protein_scaled %>% mutate(X = combined_dataset_protein$X) %>% relocate(X, .before = 1)
proteins_scaled_ids
# Boxplot from a selection of proteins
protein_scaled_ids  %>%pivot_longer(!X, names_to = "prots", values_to = "abundances")
protein_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances")
combined_dataset_protein
proteins_scaled_ids
# Boxplot from a selection of proteins
proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances")
ggplot(x= prots, y = abundances)+
geom_boxplot()
# Boxplot from a selection of proteins
proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances")
# Boxplot from a selection of proteins
proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
ggplot(x= prots, y = abundances)+
geom_boxplot()
# Boxplot from a selection of proteins
proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
ggplot(aes(x= prots, y = abundances))+
geom_boxplot()
# Boxplot from a selection of proteins
proteins_scaled_ids[,1:10] %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
ggplot(aes(x= prots, y = abundances))+
geom_boxplot()
# Boxplot from a selection of proteins
proteins_scaled_ids[,1:10] %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
ggplot(aes(x= prots, y = abundances))+
geom_boxplot() %>%
proteins_scaled_ids %>%
group_by(prots) %>%
summarise(mean(abundances))
# Boxplot from a selection of proteins
proteins_scaled_ids[,1:10] %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
ggplot(aes(x= prots, y = abundances))+
geom_boxplot() %>%
proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
group_by(prots) %>%
summarise(mean(abundances))
# Boxplot from a selection of proteins
proteins_scaled_ids[,1:10] %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
ggplot(aes(x= prots, y = abundances))+
geom_boxplot()
proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
group_by(prots) %>%
summarise(mean(abundances))
proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
group_by(prots) %>%
summarise(sd(abundances))
variatie_per_eiwit <- proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
group_by(prots) %>%
summarise(sd(abundances))
variatie_per_eiwit
variatie_per_eiwit <- proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
group_by(prots) %>%
summarise(mean(abundances))
variatie_per_eiwit
top_cv <- sort(variatie_per_eiwit, decreasing = TRUE)
variatie_per_eiwit
variatie_per_eiwit <- proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
group_by(prots) %>%
summarise(mean_abundance = mean(abundances)) %>%
arrange(desc(mean_abundance))
variatie_per_eiwit
variatie_per_eiwit <- proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
group_by(prots) %>%
summarise(mean_abundance = mean(abundances)) %>%
arrange(mean_abundance)
variatie_per_eiwit
variatie_per_eiwit <- proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
group_by(prots) %>%
summarise(mean_abundance = mean(abundances)) %>%
arrange(desc(mean_abundance))
variatie_per_eiwit
variatie_per_eiwit <- proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
group_by(prots) %>%
summarise(mean_abundance = IQR(abundances)) %>%
arrange(desc(mean_abundance))
variatie_per_eiwit
variatie_per_eiwit <- proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
group_by(prots) %>%
summarise(IQR = IQR(abundances)) %>%
arrange(desc(IQR))
IQR_per_protein <- proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
group_by(prots) %>%
summarise(IQR = IQR(abundances)) %>%
arrange(desc(IQR))
# The top 10 proteins with the highest inter queartile range
IQR_per_protein[1:10,]
IQR_per_protein <- proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
group_by(prots) %>%
summarise(IQR = sd(abundances)) %>%
arrange(desc(IQR))
# The top 10 proteins with the highest inter queartile range
IQR_per_protein[1:10,]
IQR_per_protein <- proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
group_by(prots) %>%
summarise(IQR = sd(abundances)/mean(abundances)*100) %>%
arrange(desc(IQR))
# The top 10 proteins with the highest inter queartile range
IQR_per_protein[1:10,]
IQR_per_protein <- proteins_scaled_ids %>% pivot_longer(!X, names_to = "prots", values_to = "abundances") %>%
group_by(prots) %>%
summarise(IQR = IQR(abundances)) %>%
arrange(desc(IQR))
# The top 10 proteins with the highest inter queartile range
IQR_per_protein[1:10,]
# Bekijk het resultaat
print(top_candidates)
# The top 10 proteins with the highest inter queartile range
IQR_per_protein[1:10,]
ggplot (mapping=aes (x=stage, y=combined_dataset_protein$MX1)) +
geom_boxplot () +
geom_point ( position = "jitter", color="grey")
# Visualise abundance of TIMM13 per stage of severity (WHO_temp_severity) by a boxplot
stage <- combined_dataset_features$WHO_temp_severity
ggplot (mapping = aes (x=stage, y= combined_dataset_protein$MX1)) +
geom_boxplot () +
geom_point ( position = "jitter", color="grey")
proteins_scaled_ids
ggplot (mapping = aes (x=stage, y= proteins_scaled_ids$MX1)) +
geom_boxplot () +
geom_point ( position = "jitter", color="grey")
# For an ANOVA test, we need to check the normaility within the group
combined_dataset %>%
ggplot(aes(sample = MX1)) +
geom_qq() +
geom_qq_line() +
facet_wrap(~WHO_temp_severity)
combined_dataset %>% ggplot (mapping = aes (x= WHO_temp_severity, y= proteins_scaled_ids$MX1)) +
geom_boxplot () +
geom_point ( position = "jitter", color="grey")
# Make a dataframe with only the MX1 expression pre sample and the coresponding WHO_temp_severety
df_univariate_analysis <- proteins_scaled_ids %>% select(X, MX1)
<- proteins_scaled_ids %>% select(X, MX1)
df_univariate_analysis <
# Make a dataframe with only the MX1 expression pre sample and the coresponding WHO_temp_severety
df_univariate_analysis <- proteins_scaled_ids %>% select(X, MX1)
df_univariate_analysis
# Make a dataframe with only the MX1 expression pre sample and the coresponding WHO_temp_severety
df_univariate_analysis <- proteins_scaled_ids %>% select(X, MX1)
df_univariate_analysis
# Make a dataframe with only the MX1 expression pre sample and the coresponding WHO_temp_severety
df_univariate_analysis <- proteins_scaled_ids %>% select(X, MX1) %>% mutate(WHO_temp_severity = combined_dataset_features$WHO_temp_severity)
df_univariate_analysis
# Visualise abundance of MX1 per stage of severity (WHO_temp_severity) by a boxplot
df_univariate_analysis %>% ggplot (mapping = aes (x= WHO_temp_severity, y= MX1)) +
geom_boxplot () +
geom_point ( position = "jitter", color="grey")
# For an ANOVA test, we need to check the normaility within the group
df_univariate_analysis %>%
ggplot(aes(sample = MX1)) +
geom_qq() +
geom_qq_line() +
facet_wrap(~WHO_temp_severity)
# One way ANOVA
anova_MX1 <- aov(MX1~WHO_temp_severity, data = df_univariate_analysis)
summary(anova_MX1)
posthoc_MX1
posthoc_MX1 <- TukeyHSD(anova_MX1, conf.level = 0.95)
posthoc_MX1
plot(posthoc_MX1, las = 1)
# For an ANOVA test, we need to check the normaility within the group
df_univariate_analysis %>%
ggplot(aes(sample = MX1)) +
geom_qq() +
geom_qq_line()
ggplot(aes(sample = log(MX1)) +
ggplot(aes(sample = log(MX1)) +
# For an ANOVA test, we need to check the normaility within the group
df_univariate_analysis %>%
